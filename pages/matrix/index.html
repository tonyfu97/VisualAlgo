<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Tony Fu" /><link rel="canonical" href="https://tonyfu97.github.io/VisualAlgo/pages/matrix/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Matrix - VisualAlgo</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Matrix";
        var mkdocs_page_input_path = "pages/matrix.md";
        var mkdocs_page_url = "/VisualAlgo/pages/matrix/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/django.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-274394082"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-274394082');
      </script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> VisualAlgo
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting Started</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Matrix</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#include">Include</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#struct-attributes">Struct Attributes</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#constructors">Constructors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#special-matrix-constructors">Special Matrix Constructors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#random-matrix-constructors">Random Matrix Constructors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#element-wise-operations">Element-wise Operations</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#element-wise-comparison-functions">Element-wise Comparison Functions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#matrix-operations">Matrix Operations</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#accessors">Accessors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#statistics">Statistics</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#image-operations">Image Operations</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../stimulus/">Stimulus</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../image-processing-and-enhancement/">1. Image Processing and Enhancement</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../feature-extraction/">2. Feature Extraction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../segmentation-and-grouping/">3. Segmentation and Grouping</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../object-detection-and-recognition/">4. Object Detection and Recognition</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../motion-analysis-and-tracking/">5. Motion Analysis and Tracking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../depth-perception-and-3d-reconstruction/">6. Depth Perception and 3D Reconstruction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../color-vision/">7. Color Vision</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../attention-and-search/">8. Attention and Search</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../learning-and-memory/">9. Learning and Memory</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">VisualAlgo</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>Matrix</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/tonyfu97/VisualAlgo/blob/master/docs/pages/matrix.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="visualalgomatrix-struct-documentation">VisualAlgo::Matrix Struct Documentation</h1>
<p>The <code>Matrix</code> struct provides a two-dimensional matrix object, along with numerous methods for performing operations on the matrix.</p>
<hr />
<h2 id="include">Include</h2>
<pre><code class="language-cpp">#include &quot;helpers/matrix.hpp&quot;
</code></pre>
<hr />
<h2 id="struct-attributes">Struct Attributes</h2>
<ul>
<li><code>rows</code> (<code>int</code>): The number of rows in the matrix.</li>
<li><code>cols</code> (<code>int</code>): The number of columns in the matrix.</li>
<li><code>data</code> (<code>vector&lt;vector&lt;float&gt;&gt;</code>): A 2D vector that holds the matrix data.</li>
</ul>
<hr />
<h2 id="constructors">Constructors</h2>
<ul>
<li><code>Matrix(int rows, int cols)</code>: Constructs a new <code>Matrix</code> object with the given number of rows and columns. The matrix is initialized with all elements set to 0.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4); // Creates a 3x4 matrix with all elements initialized to 0
</code></pre>
<ul>
<li><code>Matrix(int rows, int cols, float value)</code>: Constructs a new <code>Matrix</code> object with the given number of rows and columns. The matrix is initialized with all elements set to the provided value.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 1.0); // Creates a 3x4 matrix with all elements initialized to 1.0
</code></pre>
<ul>
<li><code>Matrix(vector&lt;vector&lt;float&gt;&gt; data)</code>: Constructs a new <code>Matrix</code> object with the provided 2D vector data.</li>
</ul>
<pre><code class="language-cpp">std::vector&lt;std::vector&lt;float&gt;&gt; data = {{1.0, 2.0, 3.0}, {4.0, 5.0, 6.0}};
VisualAlgo::Matrix m(data); // Creates a 2x3 matrix with the provided data
</code></pre>
<p>or </p>
<pre><code class="language-cpp">VisualAlgo::Matrix m({{1.0, 2.0, 3.0}, {4.0, 5.0, 6.0}});
</code></pre>
<ul>
<li><code>Matrix(const Matrix &amp;other)</code>: Copy constructor. Constructs a new <code>Matrix</code> object that is a copy of the provided matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m1(3, 4, 1.0);
VisualAlgo::Matrix m2(m1); // Creates a new matrix that is a copy of m1
</code></pre>
<hr />
<h2 id="special-matrix-constructors">Special Matrix Constructors</h2>
<ul>
<li><code>Matrix::zeros(int rows, int cols)</code>: Returns a new <code>Matrix</code> object with the specified number of rows and columns. All elements of the matrix are initialized to 0.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m = VisualAlgo::Matrix::zeros(3, 4); // Creates a 3x4 matrix with all elements initialized to 0
</code></pre>
<ul>
<li><code>Matrix::ones(int rows, int cols)</code>: Returns a new <code>Matrix</code> object with the specified number of rows and columns. All elements of the matrix are initialized to 1.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m = VisualAlgo::Matrix::ones(3, 4); // Creates a 3x4 matrix with all elements initialized to 1
</code></pre>
<ul>
<li><code>Matrix::eye(int rows, int cols)</code>: Returns a new identity <code>Matrix</code> object with the specified number of rows and columns. All diagonal elements are set to 1, and all other elements are set to 0.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m = VisualAlgo::Matrix::eye(3, 3); // Creates a 3x3 identity matrix
</code></pre>
<hr />
<h2 id="random-matrix-constructors">Random Matrix Constructors</h2>
<ul>
<li><code>Matrix::random(int rows, int cols)</code>: Returns a new <code>Matrix</code> object with the specified number of rows and columns. All elements of the matrix are initialized to a random floating point value in the range [0, 1].</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m = VisualAlgo::Matrix::random(3, 4); // Creates a 3x4 matrix with all elements initialized to a random value
</code></pre>
<ul>
<li><code>Matrix::random(int rows, int cols, float min, float max)</code>: Returns a new <code>Matrix</code> object with the specified number of rows and columns. All elements of the matrix are initialized to a random floating point value in the range [min, max].</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m = VisualAlgo::Matrix::random(3, 4, -1.0, 1.0); // Creates a 3x4 matrix with all elements initialized to a random value between -1.0 and 1.0
</code></pre>
<hr />
<h2 id="element-wise-operations">Element-wise Operations</h2>
<p>Element-wise operations perform the operation on each element of the matrix independently.</p>
<ul>
<li><code>Matrix &amp;operator=(const Matrix &amp;other)</code>: Assignment operator. Copies the provided matrix to the current matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m1(3, 4, 1.0);
VisualAlgo::Matrix m2 = m1; // m2 is now a copy of m1
</code></pre>
<ul>
<li><code>Matrix operator+(const Matrix &amp;other)</code>: Adds the provided matrix to the current matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m1(2, 2, 1.0);
VisualAlgo::Matrix m2(2, 2, 2.0);
VisualAlgo::Matrix m3 = m1 + m2; // m3 is now a 2x2 matrix with all elements set to 3.0
</code></pre>
<ul>
<li><code>Matrix operator+(const float &amp;other)</code>: Add the provided float to all entries.</li>
</ul>
<p>Also support other common arithmetic operators.</p>
<hr />
<h2 id="element-wise-comparison-functions">Element-wise Comparison Functions</h2>
<ul>
<li><code>Matrix::elementwise_max(const Matrix &amp;a, const Matrix &amp;b)</code>: Returns a new <code>Matrix</code> that is the element-wise maximum of matrices <code>a</code> and <code>b</code>. The dimensions of <code>a</code> and <code>b</code> must be the same.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix a = VisualAlgo::Matrix::ones(3, 4);
VisualAlgo::Matrix b = VisualAlgo::Matrix::zeros(3, 4);
VisualAlgo::Matrix m = VisualAlgo::Matrix::elementwise_max(a, b); // m will be a 3x4 matrix with all elements equal to 1
</code></pre>
<ul>
<li><code>Matrix::elementwise_min(const Matrix &amp;a, const Matrix &amp;b)</code>: Returns a new <code>Matrix</code> that is the element-wise minimum of matrices <code>a</code> and <code>b</code>. The dimensions of <code>a</code> and <code>b</code> must be the same.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix a = VisualAlgo::Matrix::ones(3, 4);
VisualAlgo::Matrix b = VisualAlgo::Matrix::zeros(3, 4);
VisualAlgo::Matrix m = VisualAlgo::Matrix::elementwise_min(a, b); // m will be a 3x4 matrix with all elements equal to 0
</code></pre>
<hr />
<h2 id="matrix-operations">Matrix Operations</h2>
<ul>
<li><code>Matrix transpose()</code>: Returns the transpose of the current matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m1(2, 3, 1.0);
VisualAlgo::Matrix m2 = m1.transpose(); // m2 is now a 3x2 matrix
</code></pre>
<ul>
<li><code>float dot(const Matrix &amp;other)</code>: Calculates the dot product of the current matrix with the provided matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m1(3, 3, 1.0);
VisualAlgo::Matrix m2(3, 3, 2.0);
float result = m1.dot(m2); // result is now 18
</code></pre>
<ul>
<li><code>Matrix Matrix::matmul(const Matrix &amp;other)</code>: Matrix multiplication.</li>
</ul>
<pre><code class="language-cpp">auto m1 = Matrix({{1, 2, 3}, {4, 5, 6}});
auto m2 = Matrix({{10, 11}, {20, 21}, {30, 31}});
auto m3 = m1.matmul(m2);
</code></pre>
<hr />
<h2 id="accessors">Accessors</h2>
<ul>
<li><code>void set(int row, int col, float value)</code>: Sets the value at the specified row and column in the matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 0.0);
m.set(1, 2, 1.0); // Sets the value at row 1, column 2 to 1.0
</code></pre>
<ul>
<li><code>const float get(int row, int col) const</code>: Returns the value at the specified row and column in the matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 1.0);
float value = m.get(2, 3); // Gets the value at row 2, column 3
</code></pre>
<ul>
<li><code>std::vector&lt;float&gt; &amp;operator[](int row)</code>: Returns the row at the specified index in the matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 1.0);
std::vector&lt;float&gt; row = m[1]; // Gets the second row of the matrix
</code></pre>
<hr />
<h2 id="statistics">Statistics</h2>
<ul>
<li><code>float sum()</code>: Returns the sum of all elements in the matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(2, 3, 1.0);
float sum = m.sum(); // sum is now 6.0
</code></pre>
<ul>
<li><code>float mean()</code>: Returns the mean (average) of all elements in the matrix.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(2, 3, 1.0);
float mean = m.mean(); // mean is now 1.0
</code></pre>
<p>Also supports <code>std()</code>, <code>max()</code>, and <code>min()</code> operations.</p>
<hr />
<h2 id="image-operations">Image Operations</h2>
<ul>
<li><code>void Matrix::load(const std::string &amp;filename)</code>: This function loads an image from the specified file path and stores it as a grayscale matrix. The function can only handle images in PPM format (P6). If the file doesn't exist or the file format is not P6, it will throw a runtime error.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m;
m.load(&quot;path_to_your_image.ppm&quot;); // Loads the image from the specified path
</code></pre>
<p>This function reads the image file as a binary file. It first reads the header to ensure that the image is in the correct format (P6), then reads the width and height of the image. The pixel data is then read and converted from RGB to grayscale using the ITU-R BT.709 luma transform. The grayscale pixel values are stored in the <code>data</code> member of the <code>Matrix</code> object.</p>
<ul>
<li><code>Matrix Matrix::load(const std::string &amp;filename, int rows, int cols)</code>: Directly load an image.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m = VisualAlgo::Matrix.load(&quot;path_to_your_image.ppm&quot;, 256, 256);
</code></pre>
<ul>
<li><code>void Matrix::save(const std::string &amp;filename, bool normalize) const</code>: This function saves the matrix as an image to the specified file path. The image is saved in PPM format (P6). The <code>normalize</code> parameter specifies whether the matrix data should be normalized to the range 0-255 before saving. If not normalized and the pixel values are not within this range, a runtime error is thrown.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 1.0);
m.save(&quot;path_to_save_image.ppm&quot;, true); // Normalizes and saves the matrix as an image to the specified path
</code></pre>
<p>This function first checks if the data needs normalization based on the <code>normalize</code> flag. If true, it normalizes the data in the <code>Matrix</code> object to the range 0-255 using the <code>normalize255()</code> function. Then it writes the image data to the file in PPM format (P6). The pixel data is written as RGB, where the R, G, and B values are all equal, resulting in a grayscale image.</p>
<ul>
<li><code>void Matrix::normalize255()</code>: This function normalizes the values in the matrix to the range 0-255. This is useful to prepare the data for saving as an image, since pixel values in an image must be in this range.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 1.0);
m.normalize255(); // Normalizes the matrix values to the range 0-255
</code></pre>
<ul>
<li><code>void Matrix::relu()</code>: This function applies the ReLU (Rectified Linear Unit) operation to the matrix. It replaces all negative pixel values with zeros, effectively achieving half-wave rectification.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, -1.0);
m.relu(); // Changes all negative values to 0
</code></pre>
<ul>
<li><code>Matrix Matrix::cross_correlation(const VisualAlgo::Matrix &amp;kernel, int padding, int stride) const</code>: This function performs the cross-correlation operation between the matrix and the provided kernel. The padding and stride parameters control the operation. If the kernel size is larger than the matrix or the stride is less than or equal to zero, or padding is negative, it will throw an invalid_argument exception.</li>
</ul>
<pre><code class="language-cpp">VisualAlgo::Matrix m(3, 4, 1.0);
VisualAlgo::Matrix kernel(2, 2, 0.5);
VisualAlgo::Matrix result = m.cross_correlation(kernel, 1, 2); // Perform cross-correlation
</code></pre>
<p>This function creates an output matrix of appropriate size based on the input matrix, kernel, padding and stride. It then performs the cross-correlation operation and stores the result in the output matrix.</p>
<ul>
<li><code>Matrix Matrix::cross_correlation(const VisualAlgo::Matrix &amp;kernel) const</code>: Same as above, but the output matrix is always the same size as the current matrix.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../getting-started/" class="btn btn-neutral float-left" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../stimulus/" class="btn btn-neutral float-right" title="Stimulus">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2023 Tony Fu</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/tonyfu97/VisualAlgo/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../getting-started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../stimulus/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
