<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Tony Fu" /><link rel="canonical" href="https://tonyfu97.github.io/VisualAlgo/pages/feature-extraction/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>2. Feature Extraction - VisualAlgo</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2. Feature Extraction";
        var mkdocs_page_input_path = "pages/feature-extraction.md";
        var mkdocs_page_url = "/VisualAlgo/pages/feature-extraction/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/django.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-274394082"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-274394082');
      </script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> VisualAlgo
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../matrix/">Matrix</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../stimulus/">Stimulus</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../image-processing-and-enhancement/">1. Image Processing and Enhancement</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">2. Feature Extraction</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#computer-vision-algorithms">Computer Vision Algorithms</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#sobel-filters-visualalgofeatureextractiongradients">Sobel Filters (VisualAlgo::FeatureExtraction::Gradients)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#include">Include</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#static-functions">Static Functions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#example-usage">Example Usage</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#warning">Warning</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#visual-examples">Visual Examples</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#non-max-suppression">Non-Max Suppression</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#canny-edge-detection">Canny Edge Detection</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#corner-detection">Corner Detection</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#blob-detection">Blob Detection</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#sift">SIFT</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#surf">SURF</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#orb">ORB</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#hog">HOG</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#neuroscience-models">Neuroscience Models</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#simple-and-complex-cell-models">Simple and Complex Cell Models</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../segmentation-and-grouping/">3. Segmentation and Grouping</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../object-detection-and-recognition/">4. Object Detection and Recognition</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../motion-analysis-and-tracking/">5. Motion Analysis and Tracking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../depth-perception-and-3d-reconstruction/">6. Depth Perception and 3D Reconstruction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../color-vision/">7. Color Vision</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../attention-and-search/">8. Attention and Search</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../learning-and-memory/">9. Learning and Memory</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">VisualAlgo</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2. Feature Extraction</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/tonyfu97/VisualAlgo/blob/master/docs/pages/feature-extraction.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2-feature-extraction">2. Feature Extraction</h1>
<h2 id="computer-vision-algorithms">Computer Vision Algorithms</h2>
<h3 id="sobel-filters-visualalgofeatureextractiongradients">Sobel Filters (<code>VisualAlgo::FeatureExtraction::Gradients</code>)</h3>
<p>The <code>Gradients</code> class in the <code>VisualAlgo::FeatureExtraction</code> namespace is a utility class for computing the x and y gradients of an image, which are important components in various computer vision and image processing tasks such as edge detection and feature extraction. </p>
<h4 id="include">Include</h4>
<pre><code class="language-cpp">#include &quot;FeatureExtraction/Gradients.hpp&quot;
</code></pre>
<h4 id="static-functions">Static Functions</h4>
<ul>
<li>
<p><code>Matrix computeXGradient(const Matrix&amp; image)</code>: This function computes the x-direction gradients of the image.</p>
</li>
<li>
<p><code>Matrix computeYGradient(const Matrix&amp; image)</code>: This function computes the y-direction gradients of the image.</p>
</li>
<li>
<p><code>Matrix computeGradientMagnitude(const Matrix&amp; xGradient, const Matrix&amp; yGradient)</code>: This function computes the magnitude of the gradient at each pixel, defined as the square root of the sum of the squares of the x and y gradients. The output is a <code>Matrix</code> where each element represents the gradient magnitude at the corresponding pixel.</p>
</li>
<li>
<p><code>Matrix computeGradientDirection(const Matrix&amp; xGradient, const Matrix&amp; yGradient, float threshold = 0.01)</code>: This function computes the direction of the gradient at each pixel, defined as the arctangent of the ratio of the y-gradient to the x-gradient. It accepts a threshold parameter to filter out low magnitude gradients, reducing the noise. Any gradient with a magnitude less than the threshold will be set to zero in the output matrix.</p>
</li>
</ul>
<h4 id="example-usage">Example Usage</h4>
<p>In this example, the <code>Gradients</code> class is used to compute the x and y gradients of an image. These gradients are then saved to file and compared with the expected gradients to ensure the computations are correct.</p>
<pre><code class="language-cpp">VisualAlgo::Matrix image;
image.load(&quot;datasets/FeatureExtraction/cat_resized.ppm&quot;);
image.normalize();

VisualAlgo::Matrix image_x_gradient, image_y_gradient;
image_x_gradient = VisualAlgo::FeatureExtraction::Gradients::computeXGradient(image);
image_y_gradient = VisualAlgo::FeatureExtraction::Gradients::computeYGradient(image);

VisualAlgo::Matrix gradient_direction;
gradient_direction = VisualAlgo::FeatureExtraction::Gradients::computeGradientDirection(image_x_gradient, image_y_gradient, 0.01);

image_x_gradient.save(&quot;datasets/FeatureExtraction/cat_x_gradient.ppm&quot;, true);
image_y_gradient.save(&quot;datasets/FeatureExtraction/cat_y_gradient.ppm&quot;, true);
gradient_direction.save(&quot;datasets/FeatureExtraction/cat_gradient_direction.ppm&quot;, true);
</code></pre>
<p>In this code, <code>computeXGradient</code> and <code>computeYGradient</code> are used to calculate the x and y gradients of the loaded image respectively. The <code>computeGradientDirection</code> function is then used to calculate the gradient direction of the image, with a threshold of 0.01 for filtering out low magnitude gradients. The resulting gradient direction image is then saved to file for later analysis or visualization.</p>
<h4 id="warning">Warning</h4>
<p>The gradient direction computation involves taking the arctangent of the ratio of the y-gradient to the x-gradient. In areas of the image where the x-gradient is near zero, this ratio can become very large or very small, leading to potential instability in the arctangent calculation. To mitigate this, we provide an option to set a threshold, under which the gradient magnitude is deemed insignificant and the direction is set to zero, reducing the influence of noise or small variations in uniform areas of the image. However, care should be taken when setting the threshold as a very high value might discard relevant information while a very low value might not effectively filter out the noise.</p>
<h4 id="visual-examples">Visual Examples</h4>
<p>Below are visual examples of the original image and the computed gradients, gradient magnitude, and gradient direction.</p>
<p>Original Image:</p>
<p><img alt="original_lighthouse" src="../../images/FeatureExtraction/lighthouse_original.png" /></p>
<p>X-direction Gradient:</p>
<p><img alt="sobel_x_lighthouse" src="../../images/FeatureExtraction/lighthouse_sobel_x.png" /></p>
<p>Y-direction Gradient:</p>
<p><img alt="sobel_y_lighthouse" src="../../images/FeatureExtraction/lighthouse_sobel_y.png" /></p>
<p>Gradient Magnitude:</p>
<p><img alt="sobel_mag_lighthouse" src="../../images/FeatureExtraction/lighthouse_sobel_magnitude.png" /></p>
<p>Gradient Direction:</p>
<p><img alt="sobel_dir_lighthouse" src="../../images/FeatureExtraction/lighthouse_sobel_direction.png" /></p>
<hr />
<h3 id="non-max-suppression">Non-Max Suppression</h3>
<hr />
<h3 id="canny-edge-detection">Canny Edge Detection</h3>
<hr />
<h3 id="corner-detection">Corner Detection</h3>
<hr />
<h3 id="blob-detection">Blob Detection</h3>
<hr />
<h3 id="sift">SIFT</h3>
<hr />
<h3 id="surf">SURF</h3>
<hr />
<h3 id="orb">ORB</h3>
<hr />
<h3 id="hog">HOG</h3>
<hr />
<h2 id="neuroscience-models">Neuroscience Models</h2>
<h3 id="simple-and-complex-cell-models">Simple and Complex Cell Models</h3>
<hr />
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../image-processing-and-enhancement/" class="btn btn-neutral float-left" title="1. Image Processing and Enhancement"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../segmentation-and-grouping/" class="btn btn-neutral float-right" title="3. Segmentation and Grouping">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2023 Tony Fu</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/tonyfu97/VisualAlgo/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../image-processing-and-enhancement/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../segmentation-and-grouping/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
